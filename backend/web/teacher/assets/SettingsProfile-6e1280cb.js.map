{"version":3,"file":"SettingsProfile-6e1280cb.js","sources":["../../../../frontend/teacher/src/views/SettingsProfile.vue"],"sourcesContent":["<template>\n  <div class='component'>\n    <section class='title'>\n      <figure class='block-avatar'>\n        <div class='control-avatar'>\n          <FileLoader :edit-preview='dataSettings.avatar' :id-for='\"file_loader_avatar\"' :name-form-data='\"avatar\"'\n                      :type-file='\"image\"'\n                      @on-upload-file='onUploadFile'></FileLoader>\n        </div>\n        <figcaption>\n          <div class='data-input'>\n            <input v-model='dataSettings.firstName' class='input' name='first_name' placeholder='Имя' type='text'>\n            <input v-model='dataSettings.lastName' class='input' name='last_name' placeholder='Фамилия' type='text'>\n          </div>\n          <p>{{ store.getTextIsTeacher }}</p>\n          <p>Дата регистрации: {{ store.getDate }}</p>\n        </figcaption>\n      </figure>\n    </section>\n    <section class='component-content'>\n      <div class='about-me'>\n        <h3>О себе</h3>\n        <div class='contenteditable' contenteditable='true' @input='setAboutMe'\n             v-html='`<pre>${store.getAboutMe}</pre>`'></div>\n      </div>\n      <div class='language-items'>\n        <h3>Преподавание языков</h3>\n        <ul v-if='dataSettings.languageItems !== null'>\n          <li v-for='(item, idx) in dataSettings.languageItems' :key='`lang_item_${idx}`'>\n            <div class='list-select'>\n              <select v-model='item.lang'>\n                <option v-for='(lang, idx) in selectOptionsLang' :key='`option_${lang}_${idx}`'\n                        :disabled='lang.disabled' :value='lang.lang' @click='setDisabledSelectLanguageOption'>\n                  {{ lang.value }}\n                </option>\n              </select>\n            </div>\n            <div class='list-select'>\n              <select v-model='item.lvl'>\n                <option v-for='(level, idx) in levelLanguageObject[item.lang]' :disabled='item.lvl === level'\n                        :value='level'>{{ level }}\n                </option>\n              </select>\n            </div>\n            <button v-if='dataSettings.languageItems.length !== 1' class='btn-red' @click='deleteLanguageItem(idx)'>\n              Удалить\n            </button>\n          </li>\n        </ul>\n        <button v-if='dataSettings.languageItems.length !== selectOptionsLang.length' class='btn-blue'\n                @click='addLanguageItem'>Добавить язык\n        </button>\n      </div>\n      <div class='interface-lang'>\n        <h3>Язык интерфейса</h3>\n        <select v-model='dataSettings.interfaceLang'>\n          <option value='ru'>Русский</option>\n          <option disabled value='en'>Английский</option>\n        </select>\n      </div>\n      <div class='save-data-settings'>\n        <h3>Сохранить изменения</h3>\n        <button class='btn-blue' @click='saveDataSettings'>Сохранить</button>\n      </div>\n    </section>\n  </div>\n</template>\n\n<script setup>\nimport { useClient } from '../stores/useClient';\nimport { ref, watch } from 'vue';\nimport FileLoader from '../components/FileLoader.vue';\nimport APIFileLoader from '../models/fileLoader';\nimport { storeToRefs } from 'pinia';\n\nconst store = useClient();\nconst { isGetDataClient } = storeToRefs(store);\n\nconst avatarFile = ref(new FormData());\nconst dataSettings = ref({\n  firstName: '',\n  lastName: '',\n  aboutMe: '',\n  languageItems: [],\n  interfaceLang: '',\n  avatar: '',\n  deleteAvatar: '',\n  isTeacher: null\n});\nconst selectOptionsLang = ref([\n  {\n    lang: 'en',\n    value: 'Английский',\n    disabled: false\n  }\n  // {\n  //   lang: 'arab',\n  //   value: 'Арабский',\n  //   disabled: false\n  // },\n  // {\n  //   lang: 'french',\n  //   value: 'Французкий',\n  //   disabled: false\n  // }\n]);\nconst levelLanguageObject = {\n  en: ['A0', 'A1', 'B1', 'B2', 'C1', 'C2']\n};\n\nwatch(isGetDataClient, (n) => {\n  if (n) {\n    dataSettings.value = {\n      firstName: store.dataClient.firstName,\n      lastName: store.dataClient.lastName,\n      aboutMe: store.dataClient.aboutMe,\n      languageItems: store.dataClient.languageItems,\n      interfaceLang: store.dataClient.interfaceLang,\n      avatar: store.dataClient.avatar,\n      deleteAvatar: '',\n      isTeacher: store.dataClient.isTeacher\n    };\n  }\n}, { immediate: true });\n\nfunction onUploadFile(data) {\n  if (data.remove) {\n    return avatarFile.value.delete(data.nameFormData);\n  }\n\n  if (data.success) {\n    avatarFile.value.append(data.nameFormData, data.file);\n  }\n}\n\nfunction setAboutMe(e) {\n  dataSettings.value.aboutMe = e.target.innerText;\n}\n\nfunction addLanguageItem() {\n  if (dataSettings.value.languageItems.length === selectOptionsLang.value.length) return;\n\n  for (let i = 0; i < selectOptionsLang.value.length; i++) {\n    const option = selectOptionsLang.value[i];\n\n    if (!option.disabled) {\n      return dataSettings.value.languageItems.push({\n        lang: '',\n        lvl: ''\n      });\n    }\n  }\n}\n\nfunction deleteLanguageItem(idx) {\n  if (dataSettings.value.languageItems.length === 1) return;\n\n  dataSettings.value.languageItems.splice(idx, 1);\n  setDisabledSelectLanguageOption();\n}\n\nfunction setDisabledSelectLanguageOption() {\n  for (let j = 0; j < selectOptionsLang.value.length; j++) {\n    const option = selectOptionsLang.value[j];\n\n    option.disabled = false;\n  }\n\n  for (let i = 0; i < dataSettings.value.languageItems.length; i++) {\n    const item = dataSettings.value.languageItems[i];\n\n    selectOptionsLang.value = selectOptionsLang.value.map(option => {\n      if (item.lang === option.lang) option.disabled = true;\n      return option;\n    });\n  }\n}\n\nsetDisabledSelectLanguageOption();\n\nconst saveDataSettings = async () => {\n  if (avatarFile.value.get('avatar') !== null) {\n    try {\n      await APIFileLoader.fileLoad(avatarFile.value, 'avatar')\n        .then(response => response.json())\n        .then(response => {\n          dataSettings.value.deleteAvatar = dataSettings.value.avatar;\n          dataSettings.value.avatar = response.avatar;\n        });\n    } catch (err) {\n      console.error(err);\n    }\n  }\n\n  Object.keys(dataSettings.value).forEach(key => {\n    if (dataSettings.value[key] !== '' && store.dataClient[key] !== undefined) {\n      store.dataClient[key] = dataSettings.value[key];\n    }\n\n  });\n\n  await store.sandSaveDataClient(dataSettings.value);\n};\n</script>\n\n<style scoped>\nfigure {\n  display: flex;\n  align-items: center;\n}\n\nfigure > img {\n  width: 90px;\n  height: 90px;\n  border-radius: 50%;\n}\n\nfigcaption {\n  margin-left: 20px;\n}\n\nfigcaption > .data-input {\n  margin-bottom: 10px;\n}\n\nfigcaption > .data-input > .input:first-child {\n  margin-right: 10px;\n}\n\nfigcaption > h1 {\n  margin-bottom: 10px;\n}\n\nfigcaption > p:last-child {\n  font-size: 14px;\n  color: #c7c7c7;\n}\n\n.component-content > div:not(:last-child) {\n  margin-bottom: 20px;\n}\n\n.component-content > div > h3 {\n  margin-bottom: 10px;\n}\n\n.language-items > ul > li {\n  display: flex;\n  align-items: center;\n  margin-bottom: 5px;\n}\n\n.language-items > ul > li > .list-select {\n  margin-right: 10px;\n}\n\n.language-items > ul {\n  margin-bottom: 10px;\n}\n\n.control-avatar {\n  width: 200px;\n  height: 90px;\n  position: relative;\n}\n\n.control-avatar > img {\n  border-radius: 50%;\n  width: 100%;\n}\n\n.control-avatar > button {\n  position: absolute;\n  top: 0;\n  right: 0;\n}\n\n.file-loader-block {\n  width: 200px;\n  height: 90px;\n  min-height: 90px;\n}\n\n.list-select > select {\n  width: 200px;\n}\n</style>"],"names":["store","useClient","isGetDataClient","storeToRefs","avatarFile","ref","dataSettings","selectOptionsLang","levelLanguageObject","watch","n","onUploadFile","data","setAboutMe","addLanguageItem","i","deleteLanguageItem","idx","setDisabledSelectLanguageOption","j","option","item","saveDataSettings","APIFileLoader","response","err","key"],"mappings":"+jCA2EA,MAAMA,EAAQC,EAAS,EACjB,CAAE,gBAAAC,CAAiB,EAAGC,EAAYH,CAAK,EAEvCI,EAAaC,EAAI,IAAI,QAAU,EAC/BC,EAAeD,EAAI,CACvB,UAAW,GACX,SAAU,GACV,QAAS,GACT,cAAe,CAAE,EACjB,cAAe,GACf,OAAQ,GACR,aAAc,GACd,UAAW,IACb,CAAC,EACKE,EAAoBF,EAAI,CAC5B,CACE,KAAM,KACN,MAAO,aACP,SAAU,EACX,CAWH,CAAC,EACKG,EAAsB,CAC1B,GAAI,CAAC,KAAM,KAAM,KAAM,KAAM,KAAM,IAAI,CACzC,EAEAC,EAAMP,EAAkBQ,GAAM,CACxBA,IACFJ,EAAa,MAAQ,CACnB,UAAWN,EAAM,WAAW,UAC5B,SAAUA,EAAM,WAAW,SAC3B,QAASA,EAAM,WAAW,QAC1B,cAAeA,EAAM,WAAW,cAChC,cAAeA,EAAM,WAAW,cAChC,OAAQA,EAAM,WAAW,OACzB,aAAc,GACd,UAAWA,EAAM,WAAW,SAClC,EAEA,EAAG,CAAE,UAAW,EAAI,CAAE,EAEtB,SAASW,EAAaC,EAAM,CAC1B,GAAIA,EAAK,OACP,OAAOR,EAAW,MAAM,OAAOQ,EAAK,YAAY,EAG9CA,EAAK,SACPR,EAAW,MAAM,OAAOQ,EAAK,aAAcA,EAAK,IAAI,CAExD,CAEA,SAASC,EAAW,EAAG,CACrBP,EAAa,MAAM,QAAU,EAAE,OAAO,SACxC,CAEA,SAASQ,GAAkB,CACzB,GAAIR,EAAa,MAAM,cAAc,SAAWC,EAAkB,MAAM,QAExE,QAASQ,EAAI,EAAGA,EAAIR,EAAkB,MAAM,OAAQQ,IAGlD,GAAI,CAFWR,EAAkB,MAAMQ,CAAC,EAE5B,SACV,OAAOT,EAAa,MAAM,cAAc,KAAK,CAC3C,KAAM,GACN,IAAK,EACb,CAAO,EAGP,CAEA,SAASU,EAAmBC,EAAK,CAC3BX,EAAa,MAAM,cAAc,SAAW,IAEhDA,EAAa,MAAM,cAAc,OAAOW,EAAK,CAAC,EAC9CC,IACF,CAEA,SAASA,GAAkC,CACzC,QAASC,EAAI,EAAGA,EAAIZ,EAAkB,MAAM,OAAQY,IAAK,CACvD,MAAMC,EAASb,EAAkB,MAAMY,CAAC,EAExCC,EAAO,SAAW,EACnB,CAED,QAASL,EAAI,EAAGA,EAAIT,EAAa,MAAM,cAAc,OAAQS,IAAK,CAChE,MAAMM,EAAOf,EAAa,MAAM,cAAcS,CAAC,EAE/CR,EAAkB,MAAQA,EAAkB,MAAM,IAAIa,IAChDC,EAAK,OAASD,EAAO,OAAMA,EAAO,SAAW,IAC1CA,EACR,CACF,CACH,CAEAF,IAEA,MAAMI,EAAmB,SAAY,CACnC,GAAIlB,EAAW,MAAM,IAAI,QAAQ,IAAM,KACrC,GAAI,CACF,MAAMmB,EAAc,SAASnB,EAAW,MAAO,QAAQ,EACpD,KAAKoB,GAAYA,EAAS,MAAM,EAChC,KAAKA,GAAY,CAChBlB,EAAa,MAAM,aAAeA,EAAa,MAAM,OACrDA,EAAa,MAAM,OAASkB,EAAS,MAC/C,CAAS,CACJ,OAAQC,EAAK,CACZ,QAAQ,MAAMA,CAAG,CAClB,CAGH,OAAO,KAAKnB,EAAa,KAAK,EAAE,QAAQoB,GAAO,CACzCpB,EAAa,MAAMoB,CAAG,IAAM,IAAM1B,EAAM,WAAW0B,CAAG,IAAM,SAC9D1B,EAAM,WAAW0B,CAAG,EAAIpB,EAAa,MAAMoB,CAAG,EAGpD,CAAG,EAED,MAAM1B,EAAM,mBAAmBM,EAAa,KAAK,CACnD"}